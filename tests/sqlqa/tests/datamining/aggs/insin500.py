# @@@ START COPYRIGHT @@@
#
# (C) Copyright 2014 Hewlett-Packard Development Company, L.P.
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
# @@@ END COPYRIGHT @@@

from ...lib import hpdci
from ...lib import gvars
import defs

_testmgr = None
_testlist = []
_dci = None

def _init(hptestmgr, testlist=[]):
    global _testmgr
    global _testlist
    global _dci
    
    _testmgr = hptestmgr
    _testlist = testlist
    # default hpdci was created using 'SQL' as the proc name.
    # this default instance shows 'SQL>' as the prompt in the log file.
    _dci = _testmgr.get_default_dci_proc()
    
def test001(desc="""insin500"""):
    global _testmgr
    global _testlist
    global _dci
    if not _testmgr.testcase_begin(_testlist): return
    # insin500.sql
    # jclear
    # 22 Apr 1997
    # set up for the new aggregate tests (variance & stddev)
    #
    stmt = """select count (*) from ints500;"""
    output = _dci.cmdexec(stmt)
    _dci.expect_file(output, defs.test_dir + """/insin500exp""", 'insin500a')
    # expect count = 0
    
    stmt = """insert into ints500 values (1,1332,719665186),
(2,4911,654275251),
(3,3528,422088816),
(4,271,954716137),
(5,2198,1396880494),
(6,4266,1098155791),
(7,4816,610157468),
(8,1669,459571621),
(9,4764,1944693114),
(10,951,444368171);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (11,4513,567934344),
(12,2692,1950389025),
(13,4516,1490608966),
(14,1592,2008828167),
(15,185,466971188),
(16,1848,947011677),
(17,1666,1026551250),
(18,1004,1783262883),
(19,1758,1685648800),
(20,129,1008174425);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (21,3331,2088441118),
(22,4421,1946898943),
(23,798,101174220),
(24,571,1563565589),
(25,650,213869866),
(26,1467,650972955),
(27,830,164354232),
(28,1152,505644689),
(29,862,222734838),
(30,454,421757431);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (31,1654,1103218788),
(32,257,1810430669),
(33,2001,1982558082),
(34,4053,1292125843),
(35,4298,17106640),
(36,4805,202864329),
(37,788,883229134),
(38,902,1679997167),
(39,1744,1861992444),
(40,4181,1855436421);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (41,35,1075014874),
(42,3071,1040971019),
(43,4390,1631772648),
(44,1961,1596077569),
(45,1103,1942715558),
(46,4144,1543689959),
(47,4629,1750733460),
(48,125,1383805245),
(49,3834,966966578),
(50,744,647756419);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (51,357,2064630784),
(52,2159,1265542201),
(53,3863,1362852478),
(54,4193,1897511903),
(55,3277,1823285292),
(56,440,327961333),
(57,3790,1074839690),
(58,1252,1451767547),
(59,3516,434246424),
(60,4671,1134797169);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (61,1465,910318422),
(62,3242,1285113815),
(63,1732,2020690116),
(64,1678,1476387757),
(65,1464,1948309218),
(66,4448,138447475),
(67,1620,1973169456),
(68,4789,1281625513),
(69,1562,2088337198),
(70,3284,269441743);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (71,1061,1330572380),
(72,872,2076629861),
(73,123,530735162),
(74,560,407950571),
(75,4446,1410101832),
(76,3909,1070516449),
(77,669,726025734),
(78,2546,82171079),
(79,466,899312372),
(80,2947,202248733);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (81,3716,1257290898),
(82,433,752940643),
(83,553,1517109856),
(84,3677,16691993),
(85,2344,1700401118),
(86,3910,1004705215),
(87,3638,1507075212),
(88,4438,851339221),
(89,171,41110506),
(90,310,1295306459);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (91,2714,249888120),
(92,3188,529181777),
(93,1518,103955638),
(94,1938,480738743),
(95,2865,1848146212),
(96,3203,301776013),
(97,3218,1276997186),
(98,525,1764507219),
(99,601,168166288),
(100,4498,1795527817);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (101,312,1872243854),
(102,2787,1697803439),
(103,1782,1911539900),
(104,23,262795333),
(105,1206,1290699674),
(106,1076,1354966219),
(107,2047,1481553064),
(108,1840,1987988417),
(109,2106,119619430),
(110,1307,425542311);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (111,735,724464468),
(112,3657,283304701),
(113,3006,510782450),
(114,1538,462512707),
(115,1236,195653824),
(116,83,201306617),
(117,1439,1672402238),
(118,2370,1650319263),
(119,4577,1343543532),
(120,2575,629175477);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (121,2795,1413416778),
(122,382,4904635),
(123,4131,2095880152),
(124,293,269526833),
(125,2276,720260630),
(126,4170,1581654935),
(127,3294,1618958724),
(128,4312,597132653),
(129,2161,830027170),
(130,4490,473915955);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (131,4454,1029343728),
(132,1028,1429474153),
(133,2965,517540334),
(134,1041,1602481807),
(135,1534,796284188),
(136,4229,855176485),
(137,84,240113402),
(138,2189,718988459),
(139,707,941729544),
(140,581,1600700065);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (141,373,1530161350),
(142,1697,476127367),
(143,3646,481176500),
(144,368,1219601373),
(145,4797,1836993362),
(146,1466,757415459),
(147,2477,64769824),
(148,2036,396992729),
(149,3624,1125239454),
(150,1308,1317247359);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (151,3704,2114403660),
(152,2451,311062933),
(153,4898,1103884970),
(154,4959,21122715),
(155,2425,1678828088),
(156,3542,1869451793),
(157,1809,508465014),
(158,130,1114454391),
(159,2125,957213156),
(160,2135,1384660557);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (161,2145,1670130946),
(162,3736,1777464851),
(163,2432,2058469456),
(164,15,1948742217),
(165,717,1729369934),
(166,250,1459347567),
(167,4700,209359228),
(168,4562,711715333),
(169,871,907958874),
(170,1025,101717131);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (171,4065,698173800),
(172,3511,1388716417),
(173,55,1196933670),
(174,2512,1827237479),
(175,1442,162632724),
(176,1270,1462916285),
(177,959,2104351410),
(178,3051,940870147),
(179,1863,605937024),
(180,344,1261731769);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (181,3590,1180364798),
(182,4223,1179370335),
(183,2284,1044599212),
(184,195,1553227381),
(185,1517,1668419082),
(186,3791,2106799739),
(187,572,812244120),
(188,46,333016305),
(189,3359,640352470),
(190,674,1444200279);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (191,2674,225192516),
(192,4776,545711917),
(193,2993,766399586),
(194,2969,918288883),
(195,1762,421766832),
(196,685,756533545),
(197,3264,1898009774),
(198,3060,2140291663),
(199,1752,966032860),
(200,1016,1991954149);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (201,4358,582094266),
(202,2819,1574614123),
(203,1459,1322884040),
(204,1708,617509985),
(205,471,929254278),
(206,387,1173236807),
(207,1166,500214900),
(208,2400,471659933),
(209,3584,530094610),
(210,1131,785860067);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (211,245,965090272),
(212,3533,1238912665),
(213,977,2086815070),
(214,1651,1806589247),
(215,1357,392238604),
(216,3399,576076629),
(217,2469,1569282410),
(218,3265,1052085851),
(219,3961,974096120),
(220,4952,1334589393);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (221,860,1415291446),
(222,4523,37008695),
(223,2361,523377316),
(224,3422,1263239181),
(225,4752,1731701698),
(226,1786,51736019),
(227,1892,1539849488),
(228,1423,1631391753),
(229,4901,836289038),
(230,3859,1765741615);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (231,2324,324803132),
(232,222,1419617221),
(233,1624,1046671642),
(234,1250,1236452427),
(235,1621,904830504),
(236,2350,632928065),
(237,4983,1664025830),
(238,3502,1046960679),
(239,3133,816018644),
(240,3041,858359421);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (241,3916,827754866),
(242,1438,535130563),
(243,683,2100103744),
(244,3224,852299129),
(245,3372,1073728190),
(246,961,1017341727),
(247,4182,1006144108),
(248,639,1049102389),
(249,32,1617548490),
(250,229,706827835);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (251,2393,1159323992),
(252,2815,1891496625),
(253,4858,112751510),
(254,4147,197466903),
(255,1011,1542961924),
(256,2527,1284376813),
(257,381,1937781538),
(258,3366,1802916275),
(259,2239,1907852144),
(260,449,1842300649);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (261,804,1779588974),
(262,1995,2147112463),
(263,1979,577332892),
(264,4510,1020029093),
(265,3792,2139686010),
(266,3541,2098218027),
(267,1336,1492406408),
(268,677,566225441),
(269,1574,1318252102),
(270,2905,1229780999);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (271,1879,1170337076),
(272,4308,1947207517),
(273,4474,469739730),
(274,777,901189027),
(275,2389,338340000),
(276,946,558546009),
(277,470,940277790),
(278,2372,321052927),
(279,508,178368204),
(280,163,1205978389);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (281,2355,678133802),
(282,70,1095667227),
(283,651,27323320),
(284,4436,1101438353),
(285,4240,1729721590),
(286,2722,331215095),
(287,3301,1565854564),
(288,573,1510375885),
(289,3015,1105193602),
(290,2281,676767123);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (291,518,1980332496),
(292,4526,738618825),
(293,1261,648424654),
(294,4259,196872175),
(295,4284,458515196),
(296,3267,1677663621),
(297,1549,1752975322),
(298,2008,1198208011),
(299,548,503493352),
(300,4418,1629031681);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (301,833,1231488934),
(302,4416,899089895),
(303,4902,214177172),
(304,1118,1921546301),
(305,1430,1424750642),
(306,2027,918821251),
(307,4294,261551872),
(308,2936,747199289),
(309,3855,1465738622),
(310,455,623168223);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (311,2918,234128172),
(312,448,287011317),
(313,2149,2112248714),
(314,4957,565523963),
(315,4,196912664),
(316,4837,142489713),
(317,3976,1800840790),
(318,21,387397335),
(319,3488,1759644612),
(320,1595,1701636781);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (321,1198,1303302626),
(322,3088,237922675),
(323,4828,1876303920),
(324,299,1897563305),
(325,76,1080830510),
(326,3234,813443535),
(327,1319,1588924252),
(328,2562,988660325),
(329,4226,127187770),
(330,1184,339448811);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (331,1890,1462879560),
(332,451,670900193),
(333,1049,1870876934),
(334,4588,775783367),
(335,4619,1631710708),
(336,2178,2118834461),
(337,4928,1567848338),
(338,3966,92575075),
(339,313,1820980576),
(340,1614,1740696089);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (341,1581,1556970206),
(342,3674,77669567),
(343,3444,2089355148),
(344,1050,686624469),
(345,3382,892495594),
(346,2957,80563675),
(347,2622,1803882616),
(348,2240,125616977),
(349,1098,1430783926),
(350,648,1858661559);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (351,4856,1882635300),
(352,345,477709197),
(353,3017,507832642),
(354,4176,225811795),
(355,2839,1379235472),
(356,4368,239307657),
(357,2488,1547458446),
(358,4674,1848818607),
(359,365,2032364476),
(360,1988,1850758981);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (361,1210,1999265434),
(362,2945,1794728907),
(363,555,1117357992),
(364,1216,916726465),
(365,745,683657830),
(366,3326,976777639),
(367,953,1255372372),
(368,444,588196349),
(369,280,1122903794),
(370,3707,544244035);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (371,1351,337355712),
(372,1280,1646881017),
(373,628,1395900478),
(374,1957,529526431),
(375,303,955726828),
(376,1945,1510906805),
(377,3634,782737994),
(378,4768,1074714043),
(379,2610,353512152),
(380,3338,2094677553);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (381,2970,851810582),
(382,4731,1338708631),
(383,2325,283843716),
(384,1063,1759743085),
(385,1680,1190801570),
(386,4134,849625395),
(387,199,2084535536),
(388,3386,1354334825),
(389,3723,1794028782),
(390,1998,551009679);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (391,879,590837788),
(392,892,1725881381),
(393,3797,1570058746),
(394,2817,1864147883),
(395,789,173144584),
(396,3871,1229329825),
(397,3636,687109062),
(398,699,1015009159),
(399,3475,2098245300),
(400,3026,680356573);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (401,876,515114578),
(402,1992,570416419),
(403,3079,1533280800),
(404,3285,653973465),
(405,2764,292042142),
(406,3544,1072244863),
(407,2449,1373053004),
(408,2158,725096597),
(409,1971,1453198762),
(410,772,1156697499);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (411,3433,1752954168),
(412,1493,583969041),
(413,2584,1571248758),
(414,4673,1259710583),
(415,1366,345451748),
(416,2552,1885586765),
(417,4557,1730586626),
(418,3237,640832787),
(419,2011,957100880),
(420,4043,28600649);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (421,4849,693846606),
(422,4994,6500207),
(423,243,1099510908),
(424,3931,1230065925),
(425,1325,1831679322),
(426,4142,1612534667),
(427,1963,1148394600),
(428,3074,404420737),
(429,3290,1878609190),
(430,4146,1946918247);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (431,3832,1469159188),
(432,2217,310221757),
(433,635,371004850),
(434,3522,1084926211),
(435,2471,58396800),
(436,4236,1030567609),
(437,853,977459966),
(438,3754,195351135),
(439,796,29406380),
(440,4640,1596032373);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (441,4632,627943690),
(442,2225,552482171),
(443,4373,836399000),
(444,2988,798098417),
(445,1232,2076527574),
(446,4044,1302376023),
(447,1204,1892871492),
(448,2152,347205165),
(449,626,706891618),
(450,260,748148979);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (451,4369,1068734896),
(452,3468,1718370345),
(453,2257,542769070),
(454,3930,550310223),
(455,2976,1689297116),
(456,2531,1985983973),
(457,2250,1682598074),
(458,2017,426996587),
(459,2874,1930751688),
(460,1814,1465568097);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (461,4968,1235637894),
(462,2642,2077481799),
(463,1578,1710108532),
(464,4774,546815133),
(465,3850,1518425362),
(466,995,1323885795),
(467,3115,964218592),
(468,4935,683181465),
(469,4735,1016836190),
(470,1348,79359039);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (471,2380,793508108),
(472,4246,1954734677),
(473,522,527332458),
(474,1701,2105281883),
(475,4676,692427256),
(476,3485,1432112849),
(477,2695,2130144566),
(478,898,543433783),
(479,3329,1194745252),
(480,3963,1938163469);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (481,883,1195714242),
(482,2761,642567379),
(483,4644,860729360),
(484,1358,1075382025),
(485,2049,616754446),
(486,2193,1913479983),
(487,423,1229307196),
(488,1647,180488901),
(489,3904,222612506),
(490,3866,311886667);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    stmt = """insert into ints500 values (491,3093,72315176),
(492,1246,926780993),
(493,3004,1305710566),
(494,1483,1255180583),
(495,2915,1606318036),
(496,1548,1318309245),
(497,3214,691586162),
(498,821,993169603),
(499,4138,376782144),
(500,94,1746191481);"""
    output = _dci.cmdexec(stmt)
    _dci.expect_inserted_msg(output, 10)
    
    stmt = """select
count (*) as CountStar,
sum (small500) as SumTotal,
avg (small500) as Average
from ints500;"""
    output = _dci.cmdexec(stmt)
    _dci.expect_file(output, defs.test_dir + """/insin500exp""", 'insin500za1')
    # expect count = 500, sum = 1188361 , avg = 2376.722
    
    stmt = """select
sum (int500) as SumTotal,
avg (int500) as Average
from ints500;"""
    output = _dci.cmdexec(stmt)
    _dci.expect_file(output, defs.test_dir + """/insin500exp""", 'insin500za2')
    # expect sum = 540323893462, avg = 1080647786.924
    
    stmt = """select
max (small500) as Maxim_N,
min (small500) as Minimum
from ints500;"""
    output = _dci.cmdexec(stmt)
    _dci.expect_file(output, defs.test_dir + """/insin500exp""", 'insin500za3')
    # expect max = 4994, min = 4
    
    stmt = """select
max (int500) as Maximum_Num,
min (int500) as Minimum
from ints500;"""
    output = _dci.cmdexec(stmt)
    _dci.expect_file(output, defs.test_dir + """/insin500exp""", 'insin500za4')
    # expect max = 2147112463, min = 4904635
    
    _testmgr.testcase_end(desc)

